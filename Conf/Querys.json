{
    "Ofertas_Activas_coppel": [
        "SELECT CURRENT_DATE AS fecha FROM WCSSYS.XMPSELLER LIMIT 1;",
        "SELECT COUNT(o.OFFER_ID) AS ofertas_activas FROM WCSSYS.CATENTRY c INNER JOIN WCSSYS.CATENTDESC c2 ON c.CATENTRY_ID = c2.CATENTRY_ID INNER JOIN WCSSYS.OFFER o ON c.CATENTRY_ID = o.CATENTRY_ID INNER JOIN WCSSYS.OFFERPRICE o2 ON o.OFFER_ID = o2.OFFER_ID LEFT JOIN WCSSYS.XMPSELLERCATREL x ON c.CATENTRY_ID = x.CATENTRY_ID LEFT JOIN WCSSYS.XMPSELLER x2 ON x.XMPSELLER_ID = x2.XMPSELLER_ID WHERE c2.PUBLISHED = 1 AND c.CATENTTYPE_ID = 'ItemBean' AND c.PARTNUMBER LIKE 'IMKP-%' AND o.PUBLISHED = 1 AND o.TRADEPOSCN_ID = 4000000000000000001 WITH UR;",
        "SELECT COUNT(o.OFFER_ID) AS ofertas_activas_unicas FROM WCSSYS.CATENTRY c INNER JOIN WCSSYS.CATENTDESC c2 ON c.CATENTRY_ID = c2.CATENTRY_ID INNER JOIN WCSSYS.OFFER o ON c.CATENTRY_ID = o.CATENTRY_ID INNER JOIN (SELECT MAX(O.PRECEDENCE) MAX_PRECEDENCE, O.TRADEPOSCN_ID, O.CATENTRY_ID FROM WCSSYS.OFFER O WHERE O.TRADEPOSCN_ID = 4000000000000000001 AND (O.STARTDATE IS NULL OR CURRENT_TIMESTAMP > O.STARTDATE) AND (O.ENDDATE IS NULL OR O.ENDDATE > CURRENT_TIMESTAMP) AND O.PUBLISHED = 1 AND (O.MINIMUMQUANTITY IN (1, 0) OR O.MINIMUMQUANTITY IS NULL) GROUP BY O.TRADEPOSCN_ID, O.CATENTRY_ID) FILTER ON O.TRADEPOSCN_ID = FILTER.TRADEPOSCN_ID AND O.CATENTRY_ID = FILTER.CATENTRY_ID AND O.PRECEDENCE = FILTER.MAX_PRECEDENCE INNER JOIN WCSSYS.OFFERPRICE o2 ON o.OFFER_ID = o2.OFFER_ID LEFT JOIN WCSSYS.XMPSELLERCATREL x ON c.CATENTRY_ID = x.CATENTRY_ID AND O.OFFER_ID=X.OFFER_ID LEFT JOIN WCSSYS.XMPSELLER x2 ON x.XMPSELLER_ID = x2.XMPSELLER_ID WHERE c2.PUBLISHED = 1 AND c.CATENTTYPE_ID = 'ItemBean' AND c.PARTNUMBER LIKE 'IMKP-%' AND o.PUBLISHED = 1 AND (O.STARTDATE IS NULL OR CURRENT_TIMESTAMP > O.STARTDATE) AND (O.ENDDATE IS NULL OR O.ENDDATE > CURRENT_TIMESTAMP) AND O.TRADEPOSCN_ID = 4000000000000000001 WITH UR;",
        "SELECT COUNT(o.OFFER_ID) AS OfertasActivasVigentes FROM WCSSYS.CATENTRY c INNER JOIN WCSSYS.CATENTDESC c2 ON c.CATENTRY_ID = c2.CATENTRY_ID INNER JOIN WCSSYS.OFFER o ON c.CATENTRY_ID = o.CATENTRY_ID INNER JOIN WCSSYS.OFFERPRICE o2 ON o.OFFER_ID = o2.OFFER_ID LEFT JOIN WCSSYS.XMPSELLERCATREL x ON c.CATENTRY_ID = x.CATENTRY_ID LEFT JOIN WCSSYS.XMPSELLER x2 ON x.XMPSELLER_ID = x2.XMPSELLER_ID WHERE c2.PUBLISHED = 1 AND c.CATENTTYPE_ID = 'ItemBean' AND c.PARTNUMBER LIKE 'IMKP-%' AND o.PUBLISHED = 1 AND o.TRADEPOSCN_ID = 4000000000000000001 AND (CURRENT_TIMESTAMP > o.STARTDATE AND CURRENT_TIMESTAMP < o.ENDDATE) WITH UR;"
    ],
    "Escenarios_Productos": [
        "SELECT CURRENT_DATE AS fecha FROM WCSSYS.XMPSELLER LIMIT 1;",
        "SELECT COUNT(c.PARTNUMBER) AS productos_sincategoria_relacionada FROM WCSSYS.CATENTRY c INNER JOIN WCSSYS.CATENTDESC c2 ON c.CATENTRY_ID = c2.CATENTRY_ID LEFT JOIN WCSSYS.CATGPENREL c3 ON c.CATENTRY_ID = c3.CATENTRY_ID WHERE c2.PUBLISHED = 1 AND c.CATENTTYPE_ID = 'ProductBean' AND c.PARTNUMBER LIKE 'MKP-%' AND c3.CATENTRY_ID IS NULL WITH UR;",
        "SELECT COUNT(c.PARTNUMBER) AS productos_sincategoria_deventas_relacionada FROM WCSSYS.CATENTRY c INNER JOIN WCSSYS.CATENTDESC c2 ON c.CATENTRY_ID = c2.CATENTRY_ID INNER JOIN WCSSYS.CATGPENREL c3 ON c.CATENTRY_ID = c3.CATENTRY_ID LEFT JOIN ( SELECT c4.CATENTRY_ID FROM WCSSYS.CATENTRY c4 INNER JOIN WCSSYS.CATENTDESC c5 ON c4.CATENTRY_ID = c5.CATENTRY_ID INNER JOIN WCSSYS.CATGPENREL c6 ON c4.CATENTRY_ID = c6.CATENTRY_ID WHERE c5.PUBLISHED = 1 AND c4.PARTNUMBER LIKE 'MKP-%' AND c4.CATENTTYPE_ID = 'ProductBean' AND c6.CATALOG_ID = 10051 ) SALESCATALOG ON c.CATENTRY_ID = SALESCATALOG.CATENTRY_ID WHERE c2.PUBLISHED = 1 AND c.CATENTTYPE_ID = 'ProductBean' AND c.PARTNUMBER LIKE 'MKP-%' AND c3.CATALOG_ID = 10001 AND SALESCATALOG.CATENTRY_ID IS NULL WITH UR;",
        "SELECT COUNT(c.PARTNUMBER) AS productos_sinIntems_relacionados FROM WCSSYS.CATENTRY c INNER JOIN WCSSYS.CATENTDESC c2 ON c.CATENTRY_ID = c2.CATENTRY_ID LEFT JOIN WCSSYS.CATENTREL c3 ON c.CATENTRY_ID = c3.CATENTRY_ID_PARENT WHERE c2.PUBLISHED = 1 AND c.CATENTTYPE_ID = 'ProductBean' AND c.PARTNUMBER LIKE 'MKP-%' AND c3.CATENTRY_ID_PARENT IS NULL WITH UR;",
        "SELECT COUNT(base.PARTNUMBER) AS producto_sinitem_publicado FROM (SELECT c.PARTNUMBER FROM WCSSYS.CATENTRY c INNER JOIN WCSSYS.CATENTDESC c2 ON c.CATENTRY_ID = c2.CATENTRY_ID INNER JOIN WCSSYS.CATENTREL c3 ON c.CATENTRY_ID = c3.CATENTRY_ID_PARENT INNER JOIN WCSSYS.CATENTRY c4 ON c3.CATENTRY_ID_CHILD = c4.CATENTRY_ID INNER JOIN WCSSYS.CATENTDESC c5 ON c4.CATENTRY_ID = c5.CATENTRY_ID WHERE c2.PUBLISHED = 1 AND c.CATENTTYPE_ID = 'ProductBean' AND c.PARTNUMBER LIKE 'MKP-%' GROUP BY c.PARTNUMBER HAVING SUM(c5.PUBLISHED) = 0) AS base WITH UR;",
        "SELECT COUNT(base.PARTNUMBER) AS productos_sinItems_conInventario FROM (SELECT c.PARTNUMBER FROM WCSSYS.CATENTRY c INNER JOIN WCSSYS.CATENTDESC c2 ON c.CATENTRY_ID = c2.CATENTRY_ID INNER JOIN WCSSYS.CATENTREL c3 ON c.CATENTRY_ID = c3.CATENTRY_ID_PARENT INNER JOIN WCSSYS.CATENTRY c4 ON c3.CATENTRY_ID_CHILD = c4.CATENTRY_ID INNER JOIN WCSSYS.CATENTDESC c5 ON c4.CATENTRY_ID = c5.CATENTRY_ID LEFT JOIN WCSSYS.INVAVL i ON c4.CATENTRY_ID = i.CATENTRY_ID WHERE c2.PUBLISHED = 1 AND c.PARTNUMBER LIKE 'MKP-%' AND c5.PUBLISHED = 1 GROUP BY c.PARTNUMBER HAVING SUM(CASE WHEN i.AVAILQUANTITY > 0 AND i.INVENTORYSTATUS = 'AVL' THEN 1 ELSE 0 END) = 0) AS base WITH UR;",
        "SELECT COUNT(DISTINCT c.CATENTRY_ID) AS productos_vigentes_conitems_sinvigencia FROM WCSSYS.CATENTRY c INNER JOIN WCSSYS.CATENTDESC c2 ON c.CATENTRY_ID = c2.CATENTRY_ID INNER JOIN WCSSYS.OFFER o ON c.CATENTRY_ID = o.CATENTRY_ID INNER JOIN WCSSYS.CATENTREL c3 ON c.CATENTRY_ID = c3.CATENTRY_ID_PARENT INNER JOIN WCSSYS.CATENTRY c4 ON c3.CATENTRY_ID_CHILD = c4.CATENTRY_ID INNER JOIN WCSSYS.CATENTDESC c5 ON c4.CATENTRY_ID = c5.CATENTRY_ID INNER JOIN WCSSYS.OFFER o2 ON c4.CATENTRY_ID = o2.CATENTRY_ID WHERE c2.PUBLISHED = 1 AND c.CATENTTYPE_ID = 'ProductBean' AND c.PARTNUMBER LIKE 'MKP-%' AND o.PUBLISHED = 1 AND o.TRADEPOSCN_ID = 4000000000000000001 AND (CURRENT_TIMESTAMP > o.STARTDATE AND CURRENT_TIMESTAMP < o.ENDDATE) AND c5.PUBLISHED = 1 AND o2.PUBLISHED = 1 AND o2.TRADEPOSCN_ID = 4000000000000000001 AND CURRENT_TIMESTAMP > o2.ENDDATE WITH UR;"
    ],
    "Escenarios_ofertas": [
        "SELECT CURRENT_DATE AS fecha FROM WCSSYS.XMPSELLER LIMIT 1;",
        "SELECT COUNT(c.CATENTRY_ID) AS buybox_ItemDespublicado FROM WCSSYS.CATENTRY c INNER JOIN WCSSYS.CATENTDESC c2 ON c.CATENTRY_ID = c2.CATENTRY_ID INNER JOIN WCSSYS.OFFER o ON c.CATENTRY_ID = o.CATENTRY_ID INNER JOIN WCSSYS.OFFERPRICE o2 ON o.OFFER_ID = o2.OFFER_ID INNER JOIN WCSSYS.XMPSELLERCATREL x ON o.CATENTRY_ID = x.CATENTRY_ID AND o.OFFER_ID = x.OFFER_ID INNER JOIN WCSSYS.CATENTREL c3 ON c.CATENTRY_ID = c3.CATENTRY_ID_PARENT INNER JOIN WCSSYS.CATENTRY c4 ON c3.CATENTRY_ID_CHILD = c4.CATENTRY_ID INNER JOIN WCSSYS.CATENTDESC c5 ON c4.CATENTRY_ID = c5.CATENTRY_ID INNER JOIN WCSSYS.OFFER o3 ON c4.CATENTRY_ID = o3.CATENTRY_ID INNER JOIN WCSSYS.OFFERPRICE o4 ON o3.OFFER_ID = o4.OFFER_ID INNER JOIN WCSSYS.XMPSELLERCATREL x2 ON o3.CATENTRY_ID = x2.CATENTRY_ID AND o3.OFFER_ID = x2.OFFER_ID WHERE c2.PUBLISHED = 1 AND c.CATENTTYPE_ID = 'ProductBean' AND c.PARTNUMBER LIKE 'MKP-%' AND o.PUBLISHED = 1 AND o.TRADEPOSCN_ID = 4000000000000000001 AND x.MPOFFER_ID = x2.MPOFFER_ID AND c5.PUBLISHED = 0 WITH UR;",
        "SELECT COUNT(O.OFFER_ID) AS Oferta_Mirakl_Invalida FROM ( SELECT O.catentry_id,MIN(O.lastupdate) AS lastupdate FROM wcssys.OFFER O JOIN wcssys.XMPSELLERCATREL XSC ON XSC.OFFER_ID = O.OFFER_ID JOIN wcssys.OFFERPRICE OP ON OP.OFFER_ID = O.OFFER_ID WHERE O.published = 1 AND O.tradeposcn_id=4000000000000000001 AND O.identifier != 0 AND O.startdate < CURRENT_TIMESTAMP AND CURRENT_TIMESTAMP < O.enddate AND O.catentry_id NOT IN ( SELECT O.catentry_id FROM wcssys.OFFER O JOIN wcssys.XMPSELLERCATREL XSC ON XSC.OFFER_ID = O.OFFER_ID JOIN wcssys.OFFERPRICE OP ON OP.OFFER_ID = O.OFFER_ID WHERE O.published = 1 AND O.tradeposcn_id=4000000000000000001 AND O.identifier != 0 AND O.startdate < CURRENT_TIMESTAMP AND CURRENT_TIMESTAMP < O.enddate GROUP BY O.catentry_id,mpoffer_id,OP.price,O.precedence HAVING COUNT(*) > 1 ) GROUP BY O.catentry_id,mpoffer_id,O.precedence HAVING COUNT(*) > 1 ) a JOIN wcssys.OFFER o ON o.catentry_id = a.catentry_id AND o.lastupdate = a.lastupdate AND o.published = 1 AND o.tradeposcn_id=4000000000000000001 WITH UR;",
        "SELECT COUNT(c.CATENTRY_ID) AS oferta_mirakl_fuera_devigencia FROM WCSSYS.CATENTRY c INNER JOIN WCSSYS.CATENTDESC c2 ON c.CATENTRY_ID = c2.CATENTRY_ID INNER JOIN WCSSYS.XMPSELLERCATREL x ON c.CATENTRY_ID = x.CATENTRY_ID INNER JOIN WCSSYS.OFFER o ON x.CATENTRY_ID = o.CATENTRY_ID AND x.OFFER_ID = o.OFFER_ID INNER JOIN WCSSYS.OFFERPRICE o2 ON o.OFFER_ID = o2.OFFER_ID WHERE c2.PUBLISHED = 1 AND o.PUBLISHED = 1 AND o.TRADEPOSCN_ID = 4000000000000000001 AND CURRENT_TIMESTAMP > o.ENDDATE WITH UR;",
        "SELECT COUNT(c.CATENTRY_ID) AS buybox_precio_item_noVigente FROM WCSSYS.CATENTRY c INNER JOIN WCSSYS.CATENTDESC c2 ON c.CATENTRY_ID = c2.CATENTRY_ID INNER JOIN WCSSYS.OFFER o ON c.CATENTRY_ID = o.CATENTRY_ID INNER JOIN WCSSYS.OFFERPRICE o2 ON o.OFFER_ID = o2.OFFER_ID INNER JOIN WCSSYS.XMPSELLERCATREL x ON o.CATENTRY_ID = x.CATENTRY_ID AND o.OFFER_ID = x.OFFER_ID INNER JOIN WCSSYS.CATENTREL c3 ON c.CATENTRY_ID = c3.CATENTRY_ID_PARENT INNER JOIN WCSSYS.CATENTRY c4 ON c3.CATENTRY_ID_CHILD = c4.CATENTRY_ID INNER JOIN WCSSYS.CATENTDESC c5 ON c4.CATENTRY_ID = c5.CATENTRY_ID INNER JOIN WCSSYS.OFFER o3 ON c4.CATENTRY_ID = o3.CATENTRY_ID INNER JOIN WCSSYS.OFFERPRICE o4 ON o3.OFFER_ID = o4.OFFER_ID INNER JOIN WCSSYS.XMPSELLERCATREL x2 ON o3.CATENTRY_ID = x2.CATENTRY_ID AND o3.OFFER_ID = x2.OFFER_ID WHERE c2.PUBLISHED = 1 AND c.CATENTTYPE_ID = 'ProductBean' AND c.PARTNUMBER LIKE 'MKP-%' AND o.PUBLISHED = 1 AND o.TRADEPOSCN_ID = 4000000000000000001 AND (CURRENT_TIMESTAMP > o.STARTDATE AND CURRENT_TIMESTAMP < o.ENDDATE) AND c5.PUBLISHED = 1 AND o3.PUBLISHED = 1 AND o3.TRADEPOSCN_ID = 4000000000000000001 AND CURRENT_TIMESTAMP > o3.ENDDATE AND x.MPOFFER_ID = x2.MPOFFER_ID AND o2.PRICE = o4.PRICE WITH UR",
        "SELECT COUNT(c.CATENTRY_ID) AS oferta_diferente_mismo_precio FROM WCSSYS.CATENTRY c INNER JOIN WCSSYS.CATENTDESC c2 ON c.CATENTRY_ID = c2.CATENTRY_ID LEFT JOIN WCSSYS.OFFER o ON c.CATENTRY_ID = o.CATENTRY_ID LEFT JOIN WCSSYS.XMPSELLERCATREL x ON o.CATENTRY_ID = x.CATENTRY_ID AND o.OFFER_ID = x.OFFER_ID LEFT JOIN WCSSYS.OFFERPRICE o2 ON o.OFFER_ID = o2.OFFER_ID WHERE o.PUBLISHED = 1 AND c2.PUBLISHED = 1 AND o.TRADEPOSCN_ID = 4000000000000000001 AND c.CATENTRY_ID IN (SELECT O3.catentry_id FROM WCSSYS.OFFER O3 JOIN WCSSYS.XMPSELLERCATREL XSC ON XSC.OFFER_ID = O3.OFFER_ID AND XSC.CATENTRY_ID = O3.CATENTRY_ID JOIN WCSSYS.OFFERPRICE OP ON OP.OFFER_ID = O3.OFFER_ID WHERE O3.published = 1 AND O3.tradeposcn_id=4000000000000000001 AND O3.identifier != 0 AND O3.startdate < CURRENT_TIMESTAMP AND CURRENT_TIMESTAMP < O3.enddate GROUP BY O3.catentry_id,XSC.mpoffer_id,OP.price,O3.precedence HAVING COUNT(O3.catentry_id) > 1) WITH UR;",
        "SELECT COUNT(contar.catentry_id) AS oferta_mirakl_diferente_mismo_precio FROM (SELECT c_out.CATENTRY_ID FROM (SELECT c.CATENTRY_ID FROM WCSSYS.CATENTRY c INNER JOIN WCSSYS.CATENTDESC c2 ON c.CATENTRY_ID = c2.CATENTRY_ID LEFT JOIN WCSSYS.OFFER o ON c.CATENTRY_ID = o.CATENTRY_ID LEFT JOIN WCSSYS.XMPSELLERCATREL x ON o.CATENTRY_ID = x.CATENTRY_ID AND o.OFFER_ID = x.OFFER_ID LEFT JOIN WCSSYS.OFFERPRICE o2 ON o.OFFER_ID = o2.OFFER_ID WHERE o.PUBLISHED = 1 AND o.TRADEPOSCN_ID = 4000000000000000001 AND c.CATENTRY_ID IN (SELECT O3.catentry_id FROM WCSSYS.OFFER O3 JOIN WCSSYS.XMPSELLERCATREL XSC ON XSC.OFFER_ID = O3.OFFER_ID AND XSC.CATENTRY_ID = O3.CATENTRY_ID JOIN WCSSYS.OFFERPRICE OP ON OP.OFFER_ID = O3.OFFER_ID WHERE O3.published = 1 AND O3.tradeposcn_id=4000000000000000001 AND O3.identifier != 0 AND O3.startdate < CURRENT_TIMESTAMP AND CURRENT_TIMESTAMP < O3.enddate AND O3.CATENTRY_ID IN (SELECT x1.CATENTRY_ID FROM WCSSYS.XMPSELLERCATREL x1 INNER JOIN WCSSYS.OFFER o1 ON x1.CATENTRY_ID = o1.CATENTRY_ID AND x1.OFFER_ID = o1.OFFER_ID WHERE o1.PUBLISHED = 1 GROUP BY x1.CATENTRY_ID HAVING COUNT(DISTINCT x1.MPOFFER_ID) > 1) GROUP BY O3.catentry_id,OP.price HAVING COUNT(O3.catentry_id) > 1) GROUP BY c.CATENTRY_ID, o2.PRICE HAVING COUNT(o2.PRICE) > 1 ) base INNER JOIN WCSSYS.CATENTRY c_out ON base.CATENTRY_ID = c_out.CATENTRY_ID INNER JOIN WCSSYS.CATENTDESC c2_out ON c_out.CATENTRY_ID = c2_out.CATENTRY_ID LEFT JOIN WCSSYS.OFFER o_out ON c_out.CATENTRY_ID = o_out.CATENTRY_ID LEFT JOIN WCSSYS.OFFERPRICE o2_out ON o_out.OFFER_ID = o2_out.OFFER_ID LEFT JOIN WCSSYS.XMPSELLERCATREL x_out ON o_out.CATENTRY_ID = x_out.CATENTRY_ID AND o_out.OFFER_ID = x_out.OFFER_ID WHERE c2_out.PUBLISHED = 1 AND o_out.TRADEPOSCN_ID = 4000000000000000001 GROUP BY c_out.CATENTRY_ID, c_out.PARTNUMBER, c2_out.PUBLISHED, o_out.OFFER_ID, o_out.STARTDATE, o_out.ENDDATE, o_out.PRECEDENCE, o_out.IDENTIFIER, o_out.PUBLISHED, o_out.LASTUPDATE, o2_out.PRICE, x_out.MPOFFER_ID, x_out.BUYBOXWEIGHT) AS contar WITH UR;",
        "SELECT COUNT(base.catentry_ID) AS oferta_mirakl_duplicada FROM (SELECT x.CATENTRY_ID FROM WCSSYS.XMPSELLERCATREL x INNER JOIN WCSSYS.OFFER o ON x.CATENTRY_ID = o.CATENTRY_ID AND x.OFFER_ID = o.OFFER_ID INNER JOIN WCSSYS.CATENTRY c ON x.CATENTRY_ID = c.CATENTRY_ID INNER JOIN WCSSYS.CATENTDESC c2 ON c.CATENTRY_ID = c2.CATENTRY_ID INNER JOIN WCSSYS.CATENTREL c3 ON c.CATENTRY_ID = c3.CATENTRY_ID_CHILD INNER JOIN WCSSYS.CATENTRY c4 ON c3.CATENTRY_ID_PARENT = c4.CATENTRY_ID INNER JOIN WCSSYS.CATENTDESC c5 ON c4.CATENTRY_ID = c5.CATENTRY_ID LEFT JOIN WCSSYS.XMPSELLER x2 ON x.XMPSELLER_ID = x2.XMPSELLER_ID WHERE o.PUBLISHED = 1 AND c2.PUBLISHED = 1 AND x.CATENTRY_ID IN (SELECT x1.CATENTRY_ID FROM WCSSYS.XMPSELLERCATREL x1 INNER JOIN WCSSYS.OFFER o1 ON x1.CATENTRY_ID = o1.CATENTRY_ID AND x1.OFFER_ID = o1.OFFER_ID WHERE o1.PUBLISHED = 1 GROUP BY x1.CATENTRY_ID HAVING COUNT(DISTINCT x1.MPOFFER_ID) > 1) GROUP BY x.CATENTRY_ID, c.PARTNUMBER, x2.NAME, c2.PUBLISHED, c4.PARTNUMBER, c5.PUBLISHED, x.MPOFFER_ID) AS base WITH UR;",
        "SELECT COUNT(c.PARTNUMBER) AS oferta_mirakl_sininventario_disponible FROM WCSSYS.CATENTRY c INNER JOIN WCSSYS.CATENTDESC c2 ON c.CATENTRY_ID = c2.CATENTRY_ID INNER JOIN WCSSYS.CATENTREL c3 ON c.CATENTRY_ID = c3.CATENTRY_ID_PARENT INNER JOIN WCSSYS.CATENTRY c4 ON c3.CATENTRY_ID_CHILD = c4.CATENTRY_ID INNER JOIN WCSSYS.CATENTDESC c5 ON c4.CATENTRY_ID = c5.CATENTRY_ID INNER JOIN WCSSYS.INVAVL i ON c4.CATENTRY_ID = i.CATENTRY_ID WHERE c2.PUBLISHED = 1 AND c.CATENTTYPE_ID = 'ProductBean' AND c.PARTNUMBER LIKE 'MKP-%' AND c5.PUBLISHED = 1 AND (i.AVAILQUANTITY <= 0 OR i.INVENTORYSTATUS = 'UAVL') WITH UR;",
        "SELECT COUNT(c.CATENTRY_ID) AS buybox_misma_oferta_mirakl_precios_diferentes FROM WCSSYS.CATENTRY c INNER JOIN WCSSYS.CATENTDESC c2 ON c.CATENTRY_ID = c2.CATENTRY_ID INNER JOIN WCSSYS.OFFER o ON c.CATENTRY_ID = o.CATENTRY_ID INNER JOIN WCSSYS.OFFERPRICE o2 ON o.OFFER_ID = o2.OFFER_ID INNER JOIN WCSSYS.XMPSELLERCATREL x ON o.CATENTRY_ID = x.CATENTRY_ID AND o.OFFER_ID = x.OFFER_ID INNER JOIN WCSSYS.CATENTREL c3 ON c.CATENTRY_ID = c3.CATENTRY_ID_PARENT INNER JOIN WCSSYS.CATENTRY c4 ON c3.CATENTRY_ID_CHILD = c4.CATENTRY_ID INNER JOIN WCSSYS.CATENTDESC c5 ON c4.CATENTRY_ID = c5.CATENTRY_ID INNER JOIN WCSSYS.OFFER o3 ON c4.CATENTRY_ID = o3.CATENTRY_ID INNER JOIN WCSSYS.OFFERPRICE o4 ON o3.OFFER_ID = o4.OFFER_ID INNER JOIN WCSSYS.XMPSELLERCATREL x2 ON o3.CATENTRY_ID = x2.CATENTRY_ID AND o3.OFFER_ID = x2.OFFER_ID WHERE c2.PUBLISHED = 1 AND c.CATENTTYPE_ID = 'ProductBean' AND c.PARTNUMBER LIKE 'MKP-%' AND o.PUBLISHED = 1 AND o.TRADEPOSCN_ID = 4000000000000000001 AND (CURRENT_TIMESTAMP > o.STARTDATE AND CURRENT_TIMESTAMP < o.ENDDATE) AND c5.PUBLISHED = 1 AND o3.PUBLISHED = 1 AND o3.TRADEPOSCN_ID = 4000000000000000001 AND (CURRENT_TIMESTAMP > o3.STARTDATE OR CURRENT_TIMESTAMP < o3.ENDDATE) AND x.MPOFFER_ID = x2.MPOFFER_ID AND o2.PRICE <> o4.PRICE WITH UR;",
        "SELECT COUNT(base.catentry_id) AS items_despublicados_ofertamirakl_duplicada FROM (SELECT x.CATENTRY_ID FROM WCSSYS.XMPSELLERCATREL x INNER JOIN WCSSYS.OFFER o ON x.CATENTRY_ID = o.CATENTRY_ID AND x.OFFER_ID = o.OFFER_ID INNER JOIN WCSSYS.CATENTRY c ON x.CATENTRY_ID = c.CATENTRY_ID INNER JOIN WCSSYS.CATENTDESC c2 ON c.CATENTRY_ID = c2.CATENTRY_ID INNER JOIN WCSSYS.CATENTREL c3 ON c.CATENTRY_ID = c3.CATENTRY_ID_CHILD INNER JOIN WCSSYS.CATENTRY c4 ON c3.CATENTRY_ID_PARENT = c4.CATENTRY_ID INNER JOIN WCSSYS.CATENTDESC c5 ON c4.CATENTRY_ID = c5.CATENTRY_ID LEFT JOIN WCSSYS.XMPSELLER x2 ON x.XMPSELLER_ID = x2.XMPSELLER_ID WHERE o.PUBLISHED = 1 AND c2.PUBLISHED = 0 AND x.CATENTRY_ID IN (SELECT x1.CATENTRY_ID FROM WCSSYS.XMPSELLERCATREL x1 INNER JOIN WCSSYS.OFFER o1 ON x1.CATENTRY_ID = o1.CATENTRY_ID AND x1.OFFER_ID = o1.OFFER_ID WHERE o1.PUBLISHED = 1 GROUP BY x1.CATENTRY_ID HAVING COUNT(DISTINCT x1.MPOFFER_ID) > 1) GROUP BY x.CATENTRY_ID, c.PARTNUMBER, x2.NAME, c2.PUBLISHED, c4.PARTNUMBER, c5.PUBLISHED, x.MPOFFER_ID) AS base WITH UR;",
        "SELECT COUNT(O.OFFER_ID) AS misma_oferta_mirakl_precio_diferente FROM ( SELECT O.catentry_id,MIN(O.lastupdate) AS lastupdate FROM WCSSYS.OFFER O JOIN WCSSYS.XMPSELLERCATREL XSC ON XSC.OFFER_ID = O.OFFER_ID JOIN WCSSYS.OFFERPRICE OP ON OP.OFFER_ID = O.OFFER_ID WHERE O.published = 1 AND O.tradeposcn_id=4000000000000000001 AND O.identifier != 0 AND O.catentry_id NOT IN ( SELECT O.catentry_id FROM WCSSYS.OFFER O JOIN WCSSYS.XMPSELLERCATREL XSC ON XSC.OFFER_ID = O.OFFER_ID JOIN WCSSYS.OFFERPRICE OP ON OP.OFFER_ID = O.OFFER_ID WHERE O.published = 1 AND O.tradeposcn_id=4000000000000000001 AND O.identifier != 0 GROUP BY O.catentry_id,mpoffer_id,OP.price,O.precedence HAVING COUNT(*) > 1 ) GROUP BY O.catentry_id,mpoffer_id,O.precedence HAVING COUNT(*) > 1 ) a JOIN wcssys.OFFER o ON o.catentry_id = a.catentry_id AND o.lastupdate = a.lastupdate AND o.published = 1 AND o.tradeposcn_id=4000000000000000001 INNER JOIN wcssys.CATENTRY c ON o.CATENTRY_ID = c.CATENTRY_ID INNER JOIN wcssys.CATENTDESC c2 ON c.CATENTRY_ID = c2.CATENTRY_ID WHERE c2.PUBLISHED = 1 WITH UR;"
    ],
    "Escenarios_Para_Negocio":[
        "SELECT Now() AS Fecha FROM ctl_pedientes limit 1;",
        "SELECT count(cp.nom_partnumber) AS productos_relacionadosaCategorias_mkpMarcadasParaBorrar FROM cat_productosmarketplace cp INNER JOIN cat_categoriasmarketplace cc ON cp.idu_categoria = cc.idu_categoria WHERE cp.opc_estatus != 'D' AND cc.opc_estatus = 'D' AND cc.opc_activo = true;",
        "SELECT COUNT(cp.nom_partnumber) AS productos_relacionados_acategoriaMKP_sinRelacionarAMenu FROM cat_productosmarketplace cp INNER JOIN cat_categoriasmarketplace cc ON cp.idu_categoria = cc.idu_categoria LEFT JOIN ctl_relacioncategoriasmarketplacecoppel cr ON cc.idu_categoria = cr.idu_categoriamarketplace WHERE cp.opc_estatus != 'D' AND cc.opc_estatus != 'D' AND cr.idu_categoriamarketplace IS NULL;",
        "SELECT COUNT(cp.nom_partnumber) AS Productos_relacionados_aMenu_deshabilitado FROM cat_productosmarketplace cp INNER JOIN cat_categoriasmarketplace cc ON cp.idu_categoria = cc.idu_categoria LEFT JOIN ctl_relacioncategoriasmarketplacecoppel cr ON cc.idu_categoria = cr.idu_categoriamarketplace LEFT JOIN cat_areasweb ca ON cr.idu_numareaweb = ca.numareaweb WHERE cp.opc_estatus != 'D' AND cc.opc_estatus != 'D' AND ca.activo = false;",
        "SELECT count(cp.nom_partnumber) AS productos_sinOferta_relacionada FROM cat_productosmarketplace cp LEFT JOIN cat_ofertasmarketplace co ON cp.idu_producto = co.idu_producto WHERE cp.opc_estatus != 'D' AND co.idu_oferta IS NULL;",
        "SELECT COUNT(base.nom_partnumber) AS productos_sinOferta_activa FROM (SELECT cp.nom_partnumber FROM cat_productosmarketplace cp INNER JOIN cat_ofertasmarketplace co ON cp.idu_producto = co.idu_producto WHERE cp.opc_estatus != 'D' AND co.opc_estatus != 'D' GROUP BY cp.nom_partnumber HAVING SUM(CASE WHEN co.opc_activo = TRUE THEN 1 ELSE 0 END) = 0) AS base;"
    ]
}